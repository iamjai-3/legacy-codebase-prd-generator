# ATA Chapter Codes (LE07) - Requirements Generation Prompt

## Purpose

You are an AI acting as a **Product Manager** and **Software Engineer**. Your task is to analyze the provided information about the ATA Chapter Codes feature (LE07) and systematically generate a comprehensive **Product Requirements Document (PRD)**. The PRD should be structured in a way that is **clear, reusable, and actionable** for both product and engineering teams.

Your output will be saved to a file named `LE07_Requirements.md` and should serve as the definitive requirements specification for implementing this feature in the new Lumina platform.

## Feature Description

LE07 allows users to set up, amend, and manage ATA (Air Transport Association) Chapter Codes and their sub-chapters, which are industry-standard codes used for categorizing aircraft systems and components. These codes serve as a critical categorization system used throughout aircraft maintenance operations.


### Key Functionality

#### Creation and Management of ATA Chapters
- Set up new chapter codes
- Customize existing chapter codes
- Delete chapter codes (including functionality to delete dummy chapter headers)

#### Sub-chapter Management
- Supports 2-character sub-chapters (upgraded from earlier versions)
- Allows sub-chapters to be defined at both system and fleet levels
- Provides validation of sub-chapter codes

#### Fleet-Specific Configuration
- Allows chapters/sub-chapters to be associated with specific fleet types
- Supports fleet-level exclusions (excluding specific sub-chapters from certain fleets)
- Enables validation that sub-chapters are applicable to the current fleet

#### Technical Features
- Maintains relationships between chapters and sub-chapters
- Supports chapter descriptions and additional metadata
- Cross-references with other modules that use ATA chapters (such as reliability reporting)

## Interface Elements

**IMPORTANT**: Screenshots of the legacy LE07 application are provided alongside this prompt and should be the primary source for interface analysis. These screenshots show the actual UI elements, layouts, workflows, and functionality of the legacy application and are critical for accurate requirements generation.

The screenshots illustrate key interfaces including:

- Chapter code management screens
- Sub-chapter configuration interfaces
- Fleet-specific configuration panels
- Data entry forms and validation messages
- Search and filtering capabilities

A thorough analysis of these screenshots should drive the UI/UX requirements in the generated document, rather than relying on inferences from code comments.

**NOTE**: While the screenshots provide essential insights into functional requirements and workflows, the implementation should NOT exactly replicate the legacy interface. Instead, the UI/UX should be redesigned using modern best practices, responsive design principles, and the Lumina design system. The legacy application interface is now obsolete and should be improved upon to enhance usability, accessibility, and user satisfaction.

## Integration Points
The ATA Chapter Codes set up in LE07 are used throughout the system, particularly in:

- Technical reliability reporting (mentioned as LE80)
- Aircraft maintenance planning
- Component monitoring and tracking
- Defect tracking and pireps (pilot reports)

## Implementation Guidelines

### Architecture and Design Principles

The requirements document should emphasize adherence to the following industry-standard principles:

1. **SOLID Principles**:
   - **Single Responsibility**: Each class should have only one reason to change
   - **Open/Closed**: Software entities should be open for extension but closed for modification
   - **Liskov Substitution**: Subtypes must be substitutable for their base types
   - **Interface Segregation**: Clients should not be forced to depend on methods they do not use
   - **Dependency Inversion**: Depend on abstractions, not on concretions

2. **Clean Architecture**:
   - Clear separation of concerns between layers
   - Domain-driven design concepts
   - Use of the repository pattern
   - Implementation of the mediator pattern where appropriate

3. **Data Access Layer**:
   - **Must use Entity Framework Core** for database interactions
   - Implement repository interfaces for each entity
   - Use of the Unit of Work pattern for transaction management
   - Proper mapping of entities to the normalized PostgreSQL tables

4. **API Design**:
   - RESTful API principles
   - Versioning strategy
   - Comprehensive documentation with Swagger/OpenAPI
   - Consistent error handling and response formats

5. **Frontend Implementation**:
   - Angular best practices and architecture
   - Component-based design
   - Reactive state management
   - Comprehensive unit testing

### Reference Resources

The requirements document should reference these key resources:

- **Source Database Tables**: The identified source Oracle tables for this feature are documented in `docs/PRDs/CAMO/LE07/LE07_SourceTables.md`.
- **Database Mapping**: The mapping between legacy Oracle tables and normalized PostgreSQL schema is available in `docs/database/NormalizationProgress.md`.
- **Schema Structure**: The normalized PostgreSQL schema for the ATA Chapter Codes feature is defined in `docs/PRDs/CAMO/LE07/LE07_normalized_schema.sql`.

### Implementation Organization

The document should specify that the implementation follow the organizational structure outlined in the NormalizationProgress.md document:

- **Business Domain**: CAMO (Continuing Airworthiness Management Organization)
- **Modules**: 
  - Maintenance Reference (for chapters, subchapters, and alert rates)
  - Fleet Management (for fleet-chapter relationships)

This organization must be reflected in the Lumina.Data project structure to maintain consistency across features.

## Output Specifications

The generated LE07_Requirements.md should include the following sections:

1. **Executive Summary**: Brief overview of the feature and its importance
2. **Functional Requirements**: Detailed descriptions of all functionality the system must provide
3. **Data Model**: Entity relationships and database schema details
4. **Technical Architecture**: Description of all components and their interactions
5. **API Specifications**: Endpoints, request/response formats, and authentication requirements
6. **UI/UX Requirements**: User interface mockups, workflows, and interaction patterns
7. **Non-Functional Requirements**: Performance, security, scalability, and compliance specifications
8. **Implementation Plan**: Recommended approach and timeline for development
9. **Testing Strategy**: Approach for validating the implementation

The document should be comprehensive, detailed, and actionable, providing all necessary information for the development team to implement the ATA Chapter Codes feature in alignment with industry best practices and the architectural patterns of the Lumina platform.

## Additional Resources

Refer to these resources when generating the requirements document:

- **Source Table Analysis**: `docs/PRDs/CAMO/LE07/LE07_SourceTables.md` - Contains the detailed analysis of legacy Oracle tables used by the ATA Chapter Codes feature
- **Normalized Schema**: `docs/PRDs/CAMO/LE07/LE07_normalized_schema.sql` - Contains the normalized PostgreSQL schema definition for the tables to be used
- **Oracle to PostgreSQL Mapping**: `docs/database/NormalizationProgress.md` - Contains the mapping between legacy Oracle tables and normalized PostgreSQL schema

### Project Structure
- **Data Access Layer**: `lumina/src/Lumina.Data`
- **Business Logic**: `lumina/src/Lumina.CAMO`
- **API Layer**: `lumina/src/Lumina.API`
- **Frontend Application**: `lumina/src/Lumina.Web`

### Reference Implementation
The Delay Code Management feature (LE03) follows similar architectural patterns and implementation approaches and can be used as a reference.

## Expected Deliverable

Generate a comprehensive requirements document named `LE07_Requirements.md` that will serve as the definitive specification for implementing the ATA Chapter Codes feature in the Lumina platform.
